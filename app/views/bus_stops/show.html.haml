%h1.page-header= t('.title')

= render partial: 'common/flash_messages'
.panel.panel-default
  .panel-heading
    .panel-title= t('.basic_info')
  .panel-body
    = render partial: 'common/show_key_value', locals: {key: BusStop.human_attribute_name(:name), value: @bus_stop.name}
    = render partial: 'common/show_key_value', locals: {key: Prefecture.human_attribute_name(:prefecture), value: @bus_stop.prefecture.try(:name)}

.panel.panel-default
  .panel-heading
    .panel-title= t('.route_info')
  %table.table
    %thead
      %th= t('.company_name')
      %th= t('.line_name')
    %tbody
      - @information.each do |id,info|
        - info[:routes].each_with_index do |route, index|
          %tr
            -if index==0
              %td(rowspan="#{info[:routes].length}")= info[:company].name
            %td= route.bus_line_name

.panel.panel-default
  .panel-heading
    .panel-title= t('.location_info')
  .panel-body
    #bus_stop_show_map
    #bus_stop_latitude.hide(data-location="#{@bus_stop.location.try(:y)}")
    #bus_stop_longitude.hide(data-location="#{@bus_stop.location.try(:x)}")
    #bus_stop_location_update.hide(data-update="#{@bus_stop.location_updated_at}")

.panel.panel-default
  .panel-heading
    .panel-title= t('.photo_info')
  .panel-body
    %ul#bus_stop_show_photos_list.list-inline
      - @photos.each do |bus_stop_photo|
        %li.photo
          %a(href="#{bus_stop_photo.photo.url}" target="_blank" )
            = image_tag bus_stop_photo.photo.url(:medium)
          %p.text-center
            %strong
              = bus_stop_photo.title
          %p.text-center
            = "#{t('.photo_user')} : #{bus_stop_photo.user.try(:username)}"
          %p.text-center
            - if current_user.try(:id) == bus_stop_photo.user.id
              = link_to t('.delete_photo'), destroy_bus_stop_photos_path(@bus_stop.id, bus_stop_photo.id), method:'delete', data:{confirm: t('.delete_confirm')}, class:"btn btn-danger"
    %hr
    - if signed_in?
      = link_to t('.add_photo'), new_bus_stop_photos_path(@bus_stop.id), class: 'btn btn-primary'

.panel.panel-default
  .panel-heading
    .panel-title= t('.update_info')
  .panel-body
    = render partial: 'common/show_key_value', locals: {key: BusStop.human_attribute_name(:location_updated_at), value: @bus_stop.location_updated_at || t('.not_register')}
    = render partial: 'common/show_key_value', locals: {key: BusStop.human_attribute_name(:last_modify_user), value: @bus_stop.last_modify_user.try(:username) || t('.not_register')}
    = render partial: 'common/show_key_value', locals: {key: BusStop.human_attribute_name(:updated_at), value: @bus_stop.updated_at}

= link_to t('helpers.submit.edit'), edit_bus_stop_path(@bus_stop.id), class: "btn btn-primary"
